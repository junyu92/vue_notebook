"use strict";(self.webpackChunknotebook=self.webpackChunknotebook||[]).push([[2921],{7803:(e,t,a)=>{a.r(t),a.d(t,{data:()=>s});const s={key:"v-7e77e48e",path:"/kernel/virtualization/secure_virt.html",title:"Secure Virtualization",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"Secure EL2 and the two Intermediate Physical Address spaces",slug:"secure-el2-and-the-two-intermediate-physical-address-spaces",children:[]}],filePathRelative:"kernel/virtualization/secure_virt.md",git:{updatedTime:1626850534e3,contributors:[{name:"Zhang Junyu",email:"zhangjunyu.92@bytedance.com",commits:1}]}}},3230:(e,t,a)=>{a.r(t),a.d(t,{default:()=>r});const s=(0,a(6252).uE)('<h1 id="secure-virtualization" tabindex="-1"><a class="header-anchor" href="#secure-virtualization" aria-hidden="true">#</a> Secure Virtualization</h1><p>When Armv8.4-A was introduced, support for EL2 in Secure state was added as an optional feature.</p><p>When a processor supports Secure EL2, the processor needs to be enabled from EL3 using the <code>SCR_EL3.EEL2</code> bit. Setting this bit enables entry into EL2, and enables use of the virtualization features in Secure state.</p><h2 id="secure-el2-and-the-two-intermediate-physical-address-spaces" tabindex="-1"><a class="header-anchor" href="#secure-el2-and-the-two-intermediate-physical-address-spaces" aria-hidden="true">#</a> Secure EL2 and the two Intermediate Physical Address spaces</h2><p>The Arm architecture defines two physical address spaces: Secure and Non-secure. In Non-secure state, the output of the stage 1 translation of a virtual machine (VM) is always Non-secure. Therefore, there is a single Intermediate Physical Address (IPA) space for stage 2 to handle.</p><p>In Secure state, the stage 1 translation of a VM can output both Secure and Non-secure addresses. The NS bit in the translation table descriptors controls whether the Secure or the Non-secure address space is outputted.</p><p>Unlike the stage 1 tables, there is no NS bit in the stage 2 table entries. For a particular IPA space, all translations result in either a Secure Physical Address or a Non-secure Physical Address. This translation is controlled by a register bit. Typically, the Non-secure IPAs translate to Non-secure PAs, and the Secure IPAs translate to Secure PAs.</p>',7),r={render:function(e,t){return s}}}}]);